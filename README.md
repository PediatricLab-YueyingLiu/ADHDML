Code by Xiaoofan Jiang and Ruijin Xie
